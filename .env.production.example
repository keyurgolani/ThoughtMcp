# ThoughtMCP Production Environment Configuration
# ============================================================================
# IMPORTANT: Copy this file to .env.production and configure for your environment
# NEVER commit .env.production with real credentials to version control
# ============================================================================

# ============================================================================
# PostgreSQL Database Configuration (REQUIRED)
# ============================================================================

# Full connection string (recommended for production)
# Format: postgresql://user:password@host:port/database?sslmode=require
DATABASE_URL=postgresql://thoughtmcp_prod:CHANGE_ME_STRONG_PASSWORD@db.example.com:5432/thoughtmcp_prod?sslmode=require

# Individual database connection settings (alternative to DATABASE_URL)
# DB_HOST=db.example.com
# DB_PORT=5432
# DB_NAME=thoughtmcp_prod
# DB_USER=thoughtmcp_prod
# DB_PASSWORD=CHANGE_ME_STRONG_PASSWORD

# Connection pool size
# Recommended: Start with 20, increase based on load testing
# Max connections = DB_POOL_SIZE * number_of_instances
DB_POOL_SIZE=20

# Connection timeout in milliseconds (default: 5000)
DB_CONNECTION_TIMEOUT=5000

# Idle connection timeout in milliseconds (default: 30000)
DB_IDLE_TIMEOUT=30000

# ============================================================================
# Embedding Model Configuration (REQUIRED)
# ============================================================================

# Embedding model to use: ollama, e5, bge
# Production recommendation: ollama with nomic-embed-text (local, zero cost)
EMBEDDING_MODEL=ollama

# Embedding vector dimension (MUST match model)
# - ollama (nomic-embed-text): 768
# - e5-large: 1024
# - bge-large: 1024
EMBEDDING_DIMENSION=768

# Ollama host URL (required if EMBEDDING_MODEL=ollama)
# For production, use internal network address or localhost if co-located
OLLAMA_HOST=http://localhost:11434

# Ollama request timeout in milliseconds (default: 30000)
OLLAMA_TIMEOUT=30000

# ============================================================================
# Logging Configuration
# ============================================================================

# Log level: DEBUG, INFO, WARN, ERROR
# Production recommendation: WARN (logs warnings and errors only)
LOG_LEVEL=WARN

# Enable structured JSON logging (recommended for production log aggregation)
LOG_FORMAT=json

# Log file path (optional, logs to stdout by default)
# LOG_FILE=/var/log/thoughtmcp/app.log

# ============================================================================
# Environment
# ============================================================================

# Environment mode (MUST be 'production' for production deployments)
NODE_ENV=production

# ============================================================================
# Performance Configuration
# ============================================================================

# Query cache TTL in seconds (default: 300 = 5 minutes)
# Higher values reduce database load but may serve stale data
CACHE_TTL=300

# Maximum processing time in milliseconds (default: 30000 = 30 seconds)
# Increase for complex reasoning tasks
MAX_PROCESSING_TIME=30000

# Enable query result caching (default: true)
ENABLE_CACHE=true

# Enable performance monitoring (default: true)
ENABLE_MONITORING=true

# ============================================================================
# Feature Flags
# ============================================================================

# Enable bias detection in reasoning (default: true)
ENABLE_BIAS_DETECTION=true

# Enable emotion detection in input (default: true)
ENABLE_EMOTION_DETECTION=true

# Enable metacognitive monitoring (default: true)
ENABLE_METACOGNITION=true

# ============================================================================
# Security Configuration
# ============================================================================

# Enable SSL/TLS for database connections (recommended: true)
DB_SSL_ENABLED=true

# Path to CA certificate for database SSL (optional)
# DB_SSL_CA=/path/to/ca-certificate.crt

# Enable rate limiting (recommended: true)
ENABLE_RATE_LIMITING=true

# Rate limit: requests per minute per user (default: 100)
RATE_LIMIT_RPM=100

# ============================================================================
# Monitoring and Observability
# ============================================================================

# Enable health check endpoint (default: true)
ENABLE_HEALTH_CHECK=true

# Health check port (default: 8080)
HEALTH_CHECK_PORT=8080

# Enable metrics collection (default: true)
ENABLE_METRICS=true

# Metrics export format: prometheus, json (default: prometheus)
METRICS_FORMAT=prometheus

# ============================================================================
# Resource Limits
# ============================================================================

# Maximum memory per operation in MB (default: 512)
MAX_MEMORY_MB=512

# Maximum concurrent operations (default: 10)
MAX_CONCURRENT_OPS=10

# Maximum batch size for bulk operations (default: 1000)
MAX_BATCH_SIZE=1000

# ============================================================================
# Temporal Decay Configuration
# ============================================================================

# Enable automatic memory decay (default: true)
ENABLE_DECAY=true

# Decay scheduler cron expression (default: daily at 2 AM)
DECAY_SCHEDULE=0 2 * * *

# Decay batch size (default: 1000)
DECAY_BATCH_SIZE=1000

# ============================================================================
# Backup Configuration (Optional)
# ============================================================================

# Enable automatic backups (default: false)
# ENABLE_AUTO_BACKUP=true

# Backup schedule cron expression (default: daily at 3 AM)
# BACKUP_SCHEDULE=0 3 * * *

# Backup retention days (default: 30)
# BACKUP_RETENTION_DAYS=30

# Backup storage path
# BACKUP_PATH=/var/backups/thoughtmcp
